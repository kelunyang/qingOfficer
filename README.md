# 清代官員數據可視化系統

這是一個基於 **CGED-Q（中國歷史官員量化數據庫-清代）** 的互動式數據視覺化分析系統，提供該數據庫中的官員職業生涯資料視覺化
（我的目的就是要畫成可以給高中生考題用的圖表，感謝Claude讓這一切成為可能）

## 📊 數據來源

本系統使用的數據來自：
- **CGED-Q Public Release 1760-1798** (2024年7月1日版本)
- **CGED-Q Public Release 1850-1864** (2022年4月19日版本)

您可以自己到港科大或是哈佛的網站去下載CSV，或是STATA版本的檔案，STATA轉CSV的python程式也附在這個庫的根目錄下

## 🚀 快速開始

### 系統需求
- Node.js 16.x 或更高版本
- 現代瀏覽器（Chrome、Firefox、Safari、Edge）
- 整個資料視覺化都在瀏覽器上完成，而且能輸出SVG圖，我自己的電腦是16G的RAM，所以都在瀏覽器跑最輕量

### 安裝步驟

1. 克隆專案
```bash
git clone https://github.com/kelunyang/qingOfficer.git
cd qingOfficer
```

2. 安裝前端依賴
```bash
cd frontend
npm install
```

3. 啟動開發服務器
```bash
npm run dev
```

4. 打開瀏覽器訪問 `http://localhost:5173`

### 生產環境部署

```bash
npm run build
```

構建完成後，將 `dist` 目錄部署到你的網頁服務器即可。

## 📈 視覺化圖表功能

**我最在乎的就是機構官員組成和職業生涯分析，我自己的使用方法是先設定好某幾個出身的人，叫電腦找出他們要轉幾次後可以到指定官職，然後鎖定這些人當作基本數據集，在切換到其他功能去看他們的各種成分分析**

### 1. 🏛️ 機構官員組成 (Institutional Composition)
分析各機構官員的出身背景和旗分組成：
- **堆疊條形圖**：展示各機構官員的旗分/出身分布
- **百分比模式**：查看各組成的相對比例
- **互動功能**：點擊條形查看具體官員名單
- **統計階段選擇**：
  - 首次任職：統計官員第一次任職的機構
  - 最後任職：統計官員最後一次任職的機構
  - 指定階段：選擇特定轉職階段進行統計
  - 所有記錄：包含所有任職記錄（可能重複計算）

### 2. 🛤️ 職務路徑分析 (Career Path Analysis)
視覺化官員從出身到最終職位的發展路徑：
- **桑基圖 (Sankey Diagram)**：展示官員職業流動的整體模式
- **智能階段計算**：自動識別最重要的職業發展階段
- **雙向篩選**：
  - 從起點篩選（出身背景）
  - 從終點篩選（最終職位/機構）
- **節點交互**：點擊任意節點查看經過該點的所有官員

### 3. 🗺️ 地區流動分析 (Regional Flow Analysis)
分析官員在不同地區間的調動模式：
- **地區篩選**：按特定地區查看官員流動
- **出身篩選**：分析不同出身背景的地區偏好
- **視覺化呈現**：清晰展示地區間的人員流動強度

### 4. 🌊 職業生涯路徑 (Career Alluvial Chart)
使用沖積圖展示官員完整的職業生涯軌跡：
- **完整路徑/簡化路徑**：選擇顯示詳細程度
- **智能步數/手動步數**：自動優化或手動控制顯示階段數
- **追蹤模式**：
  - 機構流動追蹤
  - 出身背景追蹤

## 🔧 進階功能

### 名單鎖定功能
- 從任意圖表選擇感興趣的官員群體
- 鎖定名單後，所有圖表都會基於該群體進行分析
- 支持跨圖表的一致性分析

### 數據過濾與分組
- **多維度過濾**：地區、官職、旗分、出身等
- **自定義分組**：創建機構或統計值的自定義分組
- **過濾器保存**：保存和載入常用的過濾配置

### 導出功能
- **圖表導出**：SVG、PNG 格式
- **數據導出**：CSV 格式（支持中文編碼）
- **列印模式**：優化的黑白列印樣式

### 視覺化設定
- **多種配色主題**：專業、彩虹、柔和、大地、海洋、森林等
- **圖表尺寸調整**：自定義寬度和高度
- **百分比/數值切換**：靈活的數據展示方式

## 📁 專案結構

```
qingOfficer/
├── frontend/                # Vue 3 前端應用
│   ├── src/
│   │   ├── components/     # Vue 組件
│   │   ├── stores/         # Pinia 狀態管理
│   │   ├── utils/          # 工具函數
│   │   └── App.vue         # 主應用組件
│   ├── public/             # 靜態資源
│   └── package.json        # 前端依賴
├── dta/                    # 原始數據文件（.dta 格式）
├── output/                 # 轉換後的數據文件（.csv 格式）
├── *.py                    # Python 數據處理腳本
└── README.md              # 本文件
```

## 🛠️ 技術棧

- **前端框架**：Vue 3 (Composition API)
- **UI 組件庫**：Element Plus
- **圖表庫**：D3.js
- **狀態管理**：Pinia
- **構建工具**：Vite
- **數據處理**：Python (pandas, pyreadstat)

## 📝 數據處理說明

原始數據為 Stata (.dta) 格式，使用 Python 腳本轉換為 CSV 格式：

```bash
python stata_to_csv_converter.py
```

轉換過程會：
- 保留所有中文字符編碼
- 添加 BOM 頭確保 Excel 兼容性
- 生成對應的數據集描述文件

## 🤝 貢獻指南

歡迎提交 Issue 和 Pull Request！

在提交 PR 前請確保：
1. 代碼符合專案風格
2. 所有測試通過
3. 更新相關文檔

## 📄 授權

本專案的視覺化系統代碼採用 MIT 授權。

數據使用請遵循 CGED-Q 的使用條款。

## 🙏 致謝

- 香港科技大學CGED-Q 數據庫

---

如有問題或建議，請提交 [Issue](https://github.com/yourusername/qingOfficer/issues) 或聯繫維護者。